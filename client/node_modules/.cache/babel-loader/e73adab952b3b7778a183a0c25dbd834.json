{"ast":null,"code":"import React,{useReducer}from'react';import axios from'axios';import authContext from'./authContext';import authReducer from'./authReducer';import setAuthToken from'../../utils/setAuthToken';import{REGISTER_SUCCESS,REGISTER_FAIL,USER_LOADED,AUTH_ERROR,LOGIN_SUCCESS,LOGIN_FAIL,LOGOUT,CLEAR_ERRORS}from'../types';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthState=props=>{const initialState={token:localStorage.getItem('token'),isAuthenticated:null,loading:true,user:null,error:null};const[state,dispatch]=useReducer(authReducer,initialState);// Load User\nconst loadUser=async()=>{if(localStorage.token){setAuthToken(localStorage.token);}try{const res=await axios.get('/api/auth');dispatch({type:USER_LOADED,payload:res.data});}catch(err){dispatch({type:AUTH_ERROR});}};// Register User\nconst register=async formData=>{const config={headers:{'Content-Type':'application/json'}};try{const res=await axios.post('/api/users',formData,config);dispatch({type:REGISTER_SUCCESS,payload:res.data});loadUser();}catch(err){dispatch({type:REGISTER_FAIL,payload:err.response.data.msg});}};// Login User\nconst login=async formData=>{const config={headers:{'Content-Type':'application/json'}};try{const res=await axios.post('/api/auth',formData,config);dispatch({type:LOGIN_SUCCESS,payload:res.data});loadUser();}catch(err){dispatch({type:LOGIN_FAIL,payload:err.response.data.msg});}};// Logout User\nconst logout=()=>dispatch({type:LOGOUT});// Clear Errors\nconst clearErrors=()=>dispatch({type:CLEAR_ERRORS});return/*#__PURE__*/_jsx(authContext.Provider,{value:{token:state.token,isAuthenticated:state.isAuthenticated,loading:state.loading,user:state.user,error:state.error,register,clearErrors,loadUser,login,logout},children:props.children});};export default AuthState;","map":{"version":3,"names":["React","useReducer","axios","authContext","authReducer","setAuthToken","REGISTER_SUCCESS","REGISTER_FAIL","USER_LOADED","AUTH_ERROR","LOGIN_SUCCESS","LOGIN_FAIL","LOGOUT","CLEAR_ERRORS","jsx","_jsx","AuthState","props","initialState","token","localStorage","getItem","isAuthenticated","loading","user","error","state","dispatch","loadUser","res","get","type","payload","data","err","register","formData","config","headers","post","response","msg","login","logout","clearErrors","Provider","value","children"],"sources":["/home/ali/Documents/contact-management/client/src/context/auth/AuthState.js"],"sourcesContent":["import React, { useReducer } from 'react';\nimport axios from 'axios';\nimport authContext from './authContext';\nimport authReducer from './authReducer';\nimport setAuthToken from '../../utils/setAuthToken';\n\nimport {\n    REGISTER_SUCCESS,\n    REGISTER_FAIL,\n    USER_LOADED,\n    AUTH_ERROR,\n    LOGIN_SUCCESS,\n    LOGIN_FAIL,\n    LOGOUT,\n    CLEAR_ERRORS\n} from '../types';\n\nconst AuthState = props => {\n    const initialState = {\n        token: localStorage.getItem('token'),\n        isAuthenticated: null,\n        loading: true,\n        user: null,\n        error: null\n    }\n\n    const [state, dispatch] = useReducer(authReducer, initialState);\n\n    // Load User\n    const loadUser = async () => {\n        if(localStorage.token) {\n            setAuthToken(localStorage.token);\n        }\n\n        try {\n            const res = await axios.get('/api/auth');\n            dispatch({ type: USER_LOADED, payload: res.data })\n        } catch (err) {\n            dispatch({ type: AUTH_ERROR })\n        }\n    }\n\n    // Register User\n    const register = async formData => {\n        const config = {\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        }\n        try {\n            const res = await axios.post('/api/users', formData, config);\n            dispatch({ type: REGISTER_SUCCESS, payload: res.data });\n            loadUser();\n        } catch (err) {\n            dispatch({ type: REGISTER_FAIL, payload: err.response.data.msg })\n        }\n    }\n\n    // Login User\n    const login = async formData => {\n        const config = {\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        }\n        try {\n            const res = await axios.post('/api/auth', formData, config);\n            dispatch({ type: LOGIN_SUCCESS, payload: res.data });\n            loadUser();\n        } catch (err) {\n            dispatch({ type: LOGIN_FAIL, payload: err.response.data.msg })\n        }\n    }\n\n    // Logout User\n    const logout = () => dispatch({ type: LOGOUT });\n\n    // Clear Errors\n    const clearErrors = () => dispatch({ type: CLEAR_ERRORS })\n\n    return (\n        <authContext.Provider\n            value={{\n                        token: state.token,\n                        isAuthenticated: state.isAuthenticated,\n                        loading: state.loading,\n                        user: state.user,\n                        error: state.error,\n                        register,\n                        clearErrors,\n                        loadUser,\n                        login,\n                        logout\n                    }}\n        >\n            {props.children}\n        </authContext.Provider>\n    )\n}\n\nexport default AuthState;"],"mappings":"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"},"metadata":{},"sourceType":"module"}